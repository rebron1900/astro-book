---
import type { GetStaticPathsOptions } from 'astro';
import type { Settings } from '@ts-ghost/content-api';
import { tags, settings } from '../../../data/ghost-store';

import BaseLayout from '../../../layouts/BaseLayout.astro';
import Head from '../../../components/Head.astro';
import List from '../../../components/List.astro';
import Pagination from '../../../components/Pagination.astro';
import Toc from '../../../components/Toc.astro';
import Relitu from '../../../components/Relitu';
import TocTagloop from '../../../components/TocTagloop.astro';
import Header from '../../../components/Header.astro';
import Top from '../../../components/Top.astro';
import Menu from '../../../components/Menu.astro';

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
    return tags.flatMap((tag) => {
        return paginate(tag.posts, {
            params: { slug: tag.slug },
            props: {
                tag
            },
            pageSize: 10
        });
    });
}

const { page, tag } = Astro.props;
---

<BaseLayout>
    <Head slot="head" site={settings} title={settings?.title + ' | ' + settings?.description} />

    <Header slot="header" title={settings?.title} />

    <Menu slot="menu" title={tag.name} />

    <List slot="content" page={page} isFeature={false} />

    <Pagination slot="pagination" page={page} />

    <Fragment slot="toc">
        <Relitu />
        <TocTagloop />
        <Top />
    </Fragment>
</BaseLayout>
